<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nomad's Menu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Rye&family=Marcellus&family=IM+Fell+DW+Pica&family=Black+Ops+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1a1a1a;
            --card-bg: #2c2c2c;
            --text-color: #e0e0e0;
            --gold-color: #daa520;
            --border-color: rgba(218, 165, 32, 0.3);
        }
        html { scroll-behavior: smooth; }
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Marcellus', serif;
        }
        .font-cinzel { font-family: 'Cinzel Decorative', cursive; }
        .font-rye { font-family: 'Rye', cursive; }

        /* Card Flip Animation */
        .drink-card {
            perspective: 1000px;
            background-color: transparent;
        }
        .drink-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }
        .drink-card.is-flipped .drink-card-inner {
            transform: rotateY(180deg);
        }
        .drink-card-front, .drink-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            background-color: var(--card-bg);
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
        }
        .drink-card-back {
            transform: rotateY(180deg);
        }
        .no-image { background-image: linear-gradient(to top, #3a3a3a, #1a1a1a); }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-color); }
        ::-webkit-scrollbar-thumb { background: var(--gold-color); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #b8860b; }

        .favorite-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: #888;
            font-size: 1.5rem;
            transition: color 0.3s, transform 0.3s;
            z-index: 10;
        }
        .favorite-btn:hover { transform: scale(1.2); }
        .favorite-btn.is-favorite { color: #facc15; } /* amber-400 */
        
        .card-header-front {
            padding: 1.5rem 1rem;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
            background: rgba(0,0,0,0.2);
        }
        .recipe-content {
            padding: 1rem;
            flex-grow: 1;
            overflow-y: auto;
        }
        .recipe-content-title {
             font-family: 'Cinzel Decorative', cursive;
             font-size: 1.25rem;
             color: var(--gold-color);
             margin-bottom: 0.5rem;
        }
        .recipe-list-front { list-style: none; padding-left: 0.5rem; }
        .recipe-list-front li { display: flex; align-items: center; margin-bottom: 0.5rem; }
        .recipe-list-front i { margin-right: 0.75rem; width: 20px; text-align: center; color: var(--gold-color); }
        
        .card-footer {
            padding: 0.75rem;
            text-align: center;
            font-style: italic;
            font-size: 0.875rem;
            color: #a0a0a0;
            border-top: 1px solid var(--border-color);
        }
        
        .card-back-image {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background-size: cover;
            border-radius: 1rem;
            opacity: 0.2;
            transition: opacity 0.5s;
        }
        .drink-card:hover .card-back-image { opacity: 0.3; }
        
        .card-back-content {
            position: relative;
            z-index: 1;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            height: 100%;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }
        
        .tarot-simple-meaning {
            font-family: 'Cinzel Decorative', cursive;
            font-size: 1.5rem;
            color: var(--gold-color);
            text-align: center;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tarot-story {
             font-size: 0.95rem;
             line-height: 1.6;
             color: #e0e0e0;
        }
        .tarot-card-name {
            font-family: 'Cinzel Decorative', cursive;
            font-size: 1.1rem;
            color: var(--gold-color);
            font-style: normal;
        }

        /* --- RESTORED GRID LAYOUT --- */
        #menu-grid {
            display: grid;
            grid-template-columns: 1fr; /* Single column on mobile */
            gap: 2rem;
        }
        #menu-grid .drink-card {
            height: 550px;
        }

        @media (min-width: 640px) {
            #menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            }
        }
    </style>
</head>
<body class="antialiased">

    <div id="app-container" class="min-h-screen p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="font-cinzel text-4xl md:text-5xl font-bold text-white tracking-wider">NOMAD'S</h1>
            <h2 class="font-rye text-3xl md:text-4xl text-amber-300">Sanctuary of Spirits</h2>
            
            <div class="flex justify-center items-center space-x-4 mt-6">
                 <button id="view-toggle-btn" class="font-cinzel text-lg bg-transparent border border-amber-400 text-amber-400 px-4 py-2 rounded-lg hover:bg-amber-400 hover:text-black transition-colors">Show All Tarot</button>
            </div>
        </header>

        <main>
            <div id="menu-grid">
                <!-- Drink cards will be injected here by JavaScript -->
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const cocktails = [
                // --- Major Arcana ---
                {
                    name: 'The Fool\'s Leap',
                    category: 'Adventurous',
                    tarot: 'The Fool',
                    simpleMeaning: 'New Beginnings',
                    tarotMeaning: 'Embracing the unknown with boundless potential. A leap of faith, innocence, and spontaneity. The journey is just beginning.',
                    flavorProfile: 'Spontaneous, Wild, & Unpredictable',
                    cardHook: 'For when the journey is the destination.',
                    recipe: ['1.5 oz Mezcal', '1 oz Aperol', '0.75 oz Yellow Chartreuse', '0.75 oz Lime Juice'],
                    titleColor: '#FFD700',
                    image: 'https://images.pexels.com/photos/13045415/pexels-photo-13045415.jpeg',
                    imagePosition: 'center 30%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'The Magician\'s Mix',
                    category: 'Classic',
                    tarot: 'The Magician',
                    simpleMeaning: 'Manifestation',
                    tarotMeaning: 'Harnessing the elements to manifest your desires. Power, skill, and conscious action. You have all the tools you need to succeed.',
                    flavorProfile: 'Skillful, Resourceful, & Transformative',
                    cardHook: 'Witness the transformation of simple ingredients.',
                    recipe: ['2 oz Gin', '0.75 oz Lime Juice', '0.75 oz Simple Syrup', '3 Mint Leaves'],
                    titleColor: '#8A2BE2',
                    image: 'https://images.pexels.com/photos/3408744/pexels-photo-3408744.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'The High Priestess\'s Secret',
                    category: 'Elegant',
                    tarot: 'The High Priestess',
                    simpleMeaning: 'Intuition',
                    tarotMeaning: 'Accessing the subconscious and divine knowledge. Intuition, mystery, and hidden truths. Trust your inner voice.',
                    flavorProfile: 'Mysterious, Subtle, & Deep',
                    cardHook: 'A secret worth discovering.',
                    recipe: ['1.5 oz Empress 1908 Gin', '0.5 oz Cr√®me de Violette', '0.75 oz Lemon Juice', '0.5 oz Simple Syrup', 'Egg White (optional)'],
                    titleColor: '#E6E6FA',
                    image: 'https://images.pexels.com/photos/73873/star-clusters-rosette-nebula-star-birth-region-73873.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'The Empress\'s Garden',
                    category: 'Refreshing',
                    tarot: 'The Empress',
                    simpleMeaning: 'Creativity & Nature',
                    tarotMeaning: 'Embodying femininity, nature, and abundance. Creativity, fertility, and nurturing. A connection to the Earth and sensual pleasure.',
                    flavorProfile: 'Nurturing, Lush, & Abundant',
                    cardHook: 'Creativity in a glass.',
                    recipe: ['2 oz Cucumber Vodka', '1 oz Fresh Cucumber Juice', '0.5 oz Honey Syrup', '0.5 oz Lime Juice', 'Muddled Basil Leaves'],
                    titleColor: '#90EE90',
                    image: 'https://images.pexels.com/photos/1484516/pexels-photo-1484516.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Old Fashioned Emperor',
                    category: 'Strong',
                    tarot: 'The Emperor',
                    simpleMeaning: 'Authority & Structure',
                    tarotMeaning: 'Establishing order and structure through authority. Power, stability, and leadership. A symbol of the worldly father figure.',
                    flavorProfile: 'Authoritative, Structured, & Bold',
                    cardHook: 'A timeless classic that commands respect.',
                    recipe: ['2 oz Bulleit Bourbon', '1 Sugar Cube', '2 dashes Angostura Bitters', 'Orange Peel Garnish'],
                    titleColor: '#B22222',
                    image: 'https://images.pexels.com/photos/1825642/pexels-photo-1825642.jpeg',
                    imagePosition: 'center 70%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Vieux Carre',
                    category: 'Strong',
                    tarot: 'The Hierophant',
                    simpleMeaning: 'Tradition & Belief',
                    tarotMeaning: 'A spiritual guide who represents tradition and established beliefs. Conformity, spiritual guidance, and established systems.',
                    flavorProfile: 'Traditional, Reverent, & Complex',
                    cardHook: 'A time-honored New Orleans classic.',
                    recipe: ['0.75 oz Rye Whiskey', '0.75 oz Cognac', '0.75 oz Sweet Vermouth', '1 tsp B√©n√©dictine', '2 dashes Peychaud\'s Bitters'],
                    titleColor: '#DAA520',
                    image: 'https://images.pexels.com/photos/1624438/pexels-photo-1624438.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'The Lovers\' Embrace',
                    category: 'Elegant',
                    tarot: 'The Lovers',
                    simpleMeaning: 'Union & Choice',
                    tarotMeaning: 'Representing perfect union, harmony, and love. Deep connections, partnerships, and the importance of aligning choices with values.',
                    flavorProfile: 'Passionate, Harmonious, & Dual-Faceted',
                    cardHook: 'A perfect union of flavors.',
                    recipe: ['1 oz Raspberry Gin', '1 oz White Chocolate Liqueur', 'Top with Ros√© Champagne', 'Fresh Raspberry Garnish'],
                    titleColor: '#FFB6C1',
                    image: 'https://images.pexels.com/photos/1024984/pexels-photo-1024984.jpeg',
                    imagePosition: 'center 20%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Margarita',
                    category: 'Classic',
                    tarot: 'The Chariot',
                    simpleMeaning: 'Control & Willpower',
                    tarotMeaning: 'A symbol of victory, determination, and willpower. Moving forward with confidence and control, overcoming obstacles through assertion.',
                    flavorProfile: 'Assertive, Driven, & Victorious',
                    cardHook: 'Take the reins with this powerful classic.',
                    recipe: ['2 oz Tequila', '1 oz Lime Juice', '0.75 oz Cointreau', 'Salt Rim'],
                    titleColor: '#32CD32',
                    image: 'https://images.pexels.com/photos/5946968/pexels-photo-5946968.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Long Island Iced Tea',
                    category: 'Strong',
                    tarot: 'Strength',
                    simpleMeaning: 'Inner Strength',
                    tarotMeaning: 'Represents inner strength, courage, and compassion. Taming the inner beast not with force, but with gentle persuasion and patience.',
                    flavorProfile: 'Deceptively Potent, Courageous, & Complex',
                    cardHook: 'It takes courage to handle this one.',
                    recipe: ['0.5 oz Vodka', '0.5 oz Tequila', '0.5 oz White Rum', '0.5 oz Gin', '0.5 oz Triple Sec', '0.75 oz Lemon Juice', 'Top with Cola'],
                    titleColor: '#F5DEB3',
                    image: 'https://images.pexels.com/photos/1564506/pexels-photo-1564506.jpeg',
                    imagePosition: 'center 25%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Godfather',
                    category: 'Strong',
                    tarot: 'The Hermit',
                    simpleMeaning: 'Introspection',
                    tarotMeaning: 'A symbol of soul-searching and spiritual enlightenment. Retreating from the world to find wisdom within and gain a deeper understanding.',
                    flavorProfile: 'Introspective, Smoky, & Wise',
                    cardHook: 'For a moment of quiet contemplation.',
                    recipe: ['1.5 oz Scotch', '0.75 oz Amaretto'],
                    titleColor: '#DEB887',
                    image: 'https://images.pexels.com/photos/3834339/pexels-photo-3834339.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Gin & Tonic',
                    category: 'Classic',
                    tarot: 'Wheel of Fortune',
                    simpleMeaning: 'Cycles & Karma',
                    tarotMeaning: 'Represents the cyclical nature of life, destiny, and karma. A turning point is at hand, bringing with it luck and unforeseen opportunities.',
                    flavorProfile: 'Classic, Fated, & Ever-changing',
                    cardHook: 'A simple twist of fate.',
                    recipe: ['2 oz Gin', '4 oz Tonic Water', 'Lime Wedge Garnish'],
                    titleColor: '#40E0D0',
                    image: 'https://images.pexels.com/photos/1844012/pexels-photo-1844012.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Sazerac',
                    category: 'Strong',
                    tarot: 'Justice',
                    simpleMeaning: 'Fairness & Truth',
                    tarotMeaning: 'Represents truth, fairness, and law. Decisions are being made, and cause and effect are at play. Actions have consequences.',
                    flavorProfile: 'Balanced, Objective, & Consequential',
                    cardHook: 'A perfectly balanced and consequential classic.',
                    recipe: ['2 oz Rye Whiskey', '1 Sugar Cube', '3 dashes Peychaud\'s Bitters', 'Absinthe Rinse'],
                    titleColor: '#FF6347',
                    image: 'https://images.pexels.com/photos/7125662/pexels-photo-7125662.jpeg',
                    imagePosition: 'center 20%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Aviation',
                    category: 'Elegant',
                    tarot: 'The Hanged Man',
                    simpleMeaning: 'New Perspectives',
                    tarotMeaning: 'A card of surrender and new perspectives. Pausing to see things from a different angle, leading to an eventual breakthrough.',
                    flavorProfile: 'Ethereal, Surrendering, & Enlightening',
                    cardHook: 'See the world from a different angle.',
                    recipe: ['2 oz Gin', '0.5 oz Maraschino Liqueur', '0.25 oz Cr√®me de Violette', '0.75 oz Lemon Juice'],
                    titleColor: '#D8BFD8',
                    image: 'https://images.pexels.com/photos/3734914/pexels-photo-3734914.jpeg',
                    imagePosition: 'center 80%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Corpse Reviver #2',
                    category: 'Classic',
                    tarot: 'Death',
                    simpleMeaning: 'Endings & Beginnings',
                    tarotMeaning: 'Symbolizes the end of a major phase in life to make way for the new. Transformation, endings, and new beginnings.',
                    flavorProfile: 'Transformative, Final, & Rebirthing',
                    cardHook: 'Bring yourself back from the brink.',
                    recipe: ['0.75 oz Gin', '0.75 oz Lillet Blanc', '0.75 oz Cointreau', '0.75 oz Lemon Juice', 'Absinthe Rinse'],
                    titleColor: '#F5F5F5',
                    image: 'https://images.pexels.com/photos/574111/pexels-photo-574111.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Tequila Sunrise',
                    category: 'Sweet',
                    tarot: 'Temperance',
                    simpleMeaning: 'Balance & Moderation',
                    tarotMeaning: 'The embodiment of balance, patience, and moderation. Finding the middle ground and creating harmony by blending opposing forces.',
                    flavorProfile: 'Balanced, Patient, & Harmonious',
                    cardHook: 'Finding the perfect balance between sweet and spirit.',
                    recipe: ['2 oz Tequila', '4 oz Orange Juice', '0.5 oz Grenadine'],
                    titleColor: '#FF8C00',
                    image: 'https://images.pexels.com/photos/3720984/pexels-photo-3720984.jpeg',
                    imagePosition: 'center 60%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Negroni',
                    category: 'Strong',
                    tarot: 'The Devil',
                    simpleMeaning: 'Addiction & Materialism',
                    tarotMeaning: 'Represents bondage, addiction, and materialism. Facing your shadow self and the negative patterns that hold you back.',
                    flavorProfile: 'Tempting, Binding, & Unforgettable',
                    cardHook: 'An acquired taste that might become a habit.',
                    recipe: ['1 oz Gin', '1 oz Campari', '1 oz Sweet Vermouth'],
                    titleColor: '#DC143C',
                    image: 'https://images.pexels.com/photos/459469/pexels-photo-459469.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Jager Bomb',
                    category: 'Party',
                    tarot: 'The Tower',
                    simpleMeaning: 'Sudden Upheaval',
                    tarotMeaning: 'A sudden, chaotic upheaval that leads to destruction and liberation. A necessary crisis that tears down false structures.',
                    flavorProfile: 'Chaotic, Liberating, & Explosive',
                    cardHook: 'Brace for impact.',
                    recipe: ['1.5 oz Jagermeister Liqueur', '0.5 can Red Bull'],
                    titleColor: '#3B3B3B',
                    image: 'https://images.pexels.com/photos/1118860/pexels-photo-1118860.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'The Star\'s Kiss',
                    category: 'Elegant',
                    tarot: 'The Star',
                    simpleMeaning: 'Hope & Renewal',
                    tarotMeaning: 'A period of calm and stability after a storm. Renewed hope, inspiration, and a deep connection to the universe. You are on the right path.',
                    flavorProfile: 'Bright, Ethereal, & Hopeful',
                    cardHook: 'A sip of pure inspiration.',
                    recipe: ['2 oz Gin', '0.75 oz Elderflower Liqueur', '0.5 oz Lemon Juice', 'Dash of Lavender Bitters'],
                    titleColor: '#ADD8E6',
                    image: 'https://images.pexels.com/photos/1199940/pexels-photo-1199940.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'French 75',
                    category: 'Elegant',
                    tarot: 'The Moon',
                    simpleMeaning: 'Intuition & Dreams',
                    tarotMeaning: 'Represents intuition, dreams, and the subconscious. Illuminating fears and illusions, urging trust in instinct over logic.',
                    flavorProfile: 'Dreamy, Illusory, & Intuitive',
                    cardHook: 'Don\'t let its simple appearance fool you.',
                    recipe: ['1.5 oz Gin', '0.75 oz Lemon Juice', '0.5 oz Simple Syrup', 'Top with Champagne'],
                    titleColor: '#F0E68C',
                    image: 'https://images.pexels.com/photos/39811/pexels-photo-39811.jpeg',
                    imagePosition: 'center 40%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Cosmopolitan',
                    category: 'Fruity',
                    tarot: 'The Sun',
                    simpleMeaning: 'Joy & Success',
                    tarotMeaning: 'The ultimate card of positivity, success, and joy. Enlightenment, vitality, and abundance. Your true self is shining through.',
                    flavorProfile: 'Joyful, Vibrant, & Energizing',
                    cardHook: 'Pure, unadulterated happiness.',
                    recipe: ['1.5 oz Citrus Vodka', '1 oz Cointreau', '0.5 oz Lime Juice', '0.25 oz Cranberry Juice'],
                    titleColor: '#FC8EAC',
                    image: 'https://images.pexels.com/photos/36717/amazing-animal-beautiful-beautifull.jpg',
                    imagePosition: 'center 70%',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Espresso Martini',
                    category: 'Rich',
                    tarot: 'Judgement',
                    simpleMeaning: 'Rebirth & Awakening',
                    tarotMeaning: 'A profound awakening and a call to purpose. A time of reflection and forgiveness before moving into a new level of consciousness.',
                    flavorProfile: 'Awakening, Decisive, & Revitalizing',
                    cardHook: 'A delicious judgement call.',
                    recipe: ['1 oz Vodka', '1 oz Kahl√∫a', '1 oz Fresh Espresso', '0.25 oz Simple Syrup'],
                    titleColor: '#6F4E37',
                    image: 'https://images.pexels.com/photos/1037992/pexels-photo-1037992.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Around the World',
                    category: 'Party',
                    tarot: 'The World',
                    simpleMeaning: 'Completion & Integration',
                    tarotMeaning: 'Represents the successful completion of a cycle. A moment of integration, accomplishment, and fulfillment before the next journey begins.',
                    flavorProfile: 'Integrated, Fulfilling, & Wholesome',
                    cardHook: 'The successful completion of a journey.',
                    recipe: ['0.5 oz Gin', '0.5 oz White Rum', '0.5 oz Vodka', '0.5 oz Cr√®me de Menthe', 'Top with Pineapple Juice'],
                    titleColor: '#20B2AA',
                    image: 'https://images.pexels.com/photos/220201/pexels-photo-220201.jpeg',
                    imagePosition: 'center',
                    arcana: 'Major Arcana'
                },
                {
                    name: 'Blue Hawaiian',
                    category: 'Fruity',
                    tarot: 'Ace of Cups',
                    simpleMeaning: 'New Feelings',
                    tarotMeaning: 'The beginning of new emotions, relationships, and creative endeavors. An outpouring of love and spiritual fulfillment.',
                    flavorProfile: 'Creative, Emotional, & Overwhelmingly Positive',
                    cardHook: 'Dive into a sea of new feelings.',
                    recipe: ['1 oz White Rum', '1 oz Blue Cura√ßao', '2 oz Pineapple Juice', '1 oz Cream of Coconut'],
                    titleColor: '#87CEEB',
                    image: 'https://images.pexels.com/photos/1638324/pexels-photo-1638324.jpeg',
                    imagePosition: 'center',
                    arcana: 'Suit of Cups'
                },
                {
                    name: 'Sex on the Beach',
                    category: 'Fruity',
                    tarot: 'Two of Cups',
                    simpleMeaning: 'Partnership',
                    tarotMeaning: 'A beautiful partnership based on mutual attraction and respect. The creation of a deep bond and emotional connection.',
                    flavorProfile: 'Attractive, Unified, & Romantic',
                    cardHook: 'A perfect partnership of flavors.',
                    recipe: ['1.5 oz Vodka', '0.5 oz Peach Schnapps', '1.5 oz Orange Juice', '1.5 oz Cranberry Juice'],
                    titleColor: '#FF7F50',
                    image: 'https://images.pexels.com/photos/3224953/pexels-photo-3224953.jpeg',
                    imagePosition: 'center',
                    arcana: 'Suit of Cups'
                },
            ];

            const menuGrid = document.getElementById('menu-grid');
            const viewToggleButton = document.getElementById('view-toggle-btn');
            const DRINKS_FAVORITES_KEY = 'nomad_drink_favorites';
            const TAROT_FAVORITES_KEY = 'nomad_tarot_favorites';

            let favoriteDrinks = [];
            let favoriteTarot = [];
            let isGlobalTarotView = false;
            const titleFonts = ['Rye', 'Cinzel Decorative', 'IM Fell DW Pica', 'Marcellus'];
            
            let currentRenderedItems = [];
            const renderBatchSize = 8;
            let currentRenderIndex = 0;
            let isLoadingNextBatch = false;

            const getIngredientInfo = (ingredientName) => {
                const lowerIng = ingredientName.toLowerCase();
                const defaultInfo = { icon: 'fa-mortar-pestle', colorClass: 'text-gray-400' };
                if (['whiskey', 'bourbon', 'scotch', 'rye'].some(s => lowerIng.includes(s))) return { icon: 'fa-glass-whiskey', colorClass: 'text-orange-400' };
                if (lowerIng.includes('gin')) return { icon: 'fa-bottle-droplet', colorClass: 'text-sky-300' };
                if (lowerIng.includes('vodka')) return { icon: 'fa-bottle-droplet', colorClass: 'text-slate-300' };
                if (lowerIng.includes('tequila') || lowerIng.includes('mezcal')) return { icon: 'fa-leaf', colorClass: 'text-lime-400' };
                if (lowerIng.includes('rum')) return { icon: 'fa-anchor', colorClass: 'text-blue-300' };
                if (['liqueur', 'chartreuse', 'aperol', 'amaretto', 'schnapps', 'cointreau', 'campari', 'kahl√∫a'].some(s => lowerIng.includes(s))) return { icon: 'fa-wine-bottle', colorClass: 'text-fuchsia-400' };
                if (lowerIng.includes('bitters')) return { icon: 'fa-eye-dropper', colorClass: 'text-red-400' };
                if (lowerIng.includes('juice')) return { icon: 'fa-lemon', colorClass: 'text-yellow-300' };
                if (lowerIng.includes('syrup') || lowerIng.includes('agave') || lowerIng.includes('grenadine')) return { icon: 'fa-stroopwafel', colorClass: 'text-amber-200' };
                if (lowerIng.includes('mint') || lowerIng.includes('basil')) return { icon: 'fa-seedling', colorClass: 'text-green-400' };
                if (lowerIng.includes('garnish') || lowerIng.includes('peel') || lowerIng.includes('wedge') || lowerIng.includes('rim')) return { icon: 'fa-spa', colorClass: 'text-pink-400' };
                if (lowerIng.includes('champagne')) return { icon: 'fa-champagne-glasses', colorClass: 'text-yellow-200' };
                if (lowerIng.includes('vermouth')) return { icon: 'fa-wine-glass', colorClass: 'text-red-300' };
                return defaultInfo;
            };

            const appendNextBatch = () => {
                if (isLoadingNextBatch) return;

                const itemsToAppend = currentRenderedItems.slice(currentRenderIndex, currentRenderIndex + renderBatchSize);
                if (itemsToAppend.length === 0) {
                    window.removeEventListener('scroll', handleInfiniteScroll);
                    return;
                }
                
                isLoadingNextBatch = true;

                const batchHtml = itemsToAppend.map((item, index) => {
                    const globalIndex = currentRenderIndex + index;
                    const titleFont = titleFonts[globalIndex % titleFonts.length];
                    const bgPosStyle = item.imagePosition ? `background-position: ${item.imagePosition};` : '';
                    const drinkFavoriteClass = favoriteDrinks.includes(item.name) ? 'is-favorite' : '';
                    const tarotFavoriteClass = favoriteTarot.includes(item.name) ? 'is-favorite' : '';

                    return `
                        <div class="drink-card" data-name="${item.name}">
                            <div class="drink-card-inner">
                                <div class="drink-card-front">
                                    <div class="card-header-front"><h3 class="drink-card-title text-2xl font-bold" style="font-family: '${titleFont}', cursive; line-height: 1.1; color: ${item.titleColor};">${item.name}</h3></div>
                                    <div class="px-4 pt-4 text-center relative">
                                        <button class="favorite-btn ${drinkFavoriteClass}" data-type="drink"><i class="fas fa-star"></i></button>
                                        <h4 class="recipe-content-title">Flavor Profile</h4>
                                        <p class="font-rye text-amber-300 text-base leading-relaxed">${item.flavorProfile}</p>
                                    </div>
                                    <div class="recipe-content">
                                        <ul class="recipe-list-front">${item.recipe.map(r => { const ingInfo = getIngredientInfo(r); return `<li><i class="fas ${ingInfo.icon} ${ingInfo.colorClass}"></i><span>${r}</span></li>`; }).join('')}</ul>
                                    </div>
                                    <div class="card-footer">${item.cardHook}</div>
                                </div>
                                <div class="drink-card-back ${!item.image ? 'no-image' : ''}">
                                   <button class="favorite-btn ${tarotFavoriteClass}" data-type="tarot"><i class="fas fa-star"></i></button>
                                   <div class="card-back-image lazy-bg" ${item.image ? `data-bg="url('${item.image}')"` : ''} style="${bgPosStyle}"></div>
                                   <div class="card-back-content">
                                       <p class="tarot-simple-meaning">${item.simpleMeaning}</p>
                                       <div class="flex-grow min-h-0 overflow-y-auto pr-1">
                                           <p class="tarot-story">${item.tarotMeaning}</p>
                                       </div>
                                    </div>
                                    <div class="card-footer"><h3 class="tarot-card-name">${item.tarot}</h3></div>
                                </div>
                            </div>
                        </div>`;
                }).join('');

                menuGrid.insertAdjacentHTML('beforeend', batchHtml);
                currentRenderIndex += itemsToAppend.length;
                setupLazyLoading();
                setupCardEventListeners();

                if (isGlobalTarotView) {
                    const justAddedCards = Array.from(menuGrid.children).slice(-itemsToAppend.length);
                    justAddedCards.forEach(card => card.classList.add('is-flipped'));
                }
                
                isLoadingNextBatch = false;
            };

            const handleInfiniteScroll = () => {
                const buffer = 500; // 500px from the bottom
                if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - buffer) {
                    if(!isLoadingNextBatch) {
                       appendNextBatch();
                    }
                }
            };
            
            const renderMenuInBatches = (itemsToRender) => {
                menuGrid.innerHTML = '';
                currentRenderedItems = itemsToRender;
                currentRenderIndex = 0;
                isLoadingNextBatch = false;
                window.removeEventListener('scroll', handleInfiniteScroll);

                appendNextBatch(); // Load the first batch

                if (currentRenderIndex < currentRenderedItems.length) {
                    window.addEventListener('scroll', handleInfiniteScroll);
                }
            };
            
            const setupLazyLoading = () => {
                const lazyImages = document.querySelectorAll('.lazy-bg:not(.loaded)');
                const observerOptions = { rootMargin: "0px 0px 300px 0px" };

                if ("IntersectionObserver" in window) {
                    const imageObserver = new IntersectionObserver((entries, observer) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const imageContainer = entry.target;
                                const imageUrl = imageContainer.dataset.bg;
                                if (imageUrl) {
                                    imageContainer.style.backgroundImage = imageUrl;
                                    imageContainer.classList.add('loaded');
                                }
                                imageObserver.unobserve(imageContainer);
                            }
                        });
                    }, observerOptions);
                    lazyImages.forEach(img => imageObserver.observe(img));
                } else { // Fallback for older browsers
                    lazyImages.forEach(img => {
                        const imageUrl = img.dataset.bg;
                        if (imageUrl) img.style.backgroundImage = imageUrl;
                    });
                }
            };
            
            const setCardView = (isTarot) => {
                const cards = document.querySelectorAll('#menu-grid .drink-card');
                if (isTarot) {
                    cards.forEach(card => card.classList.add('is-flipped'));
                    viewToggleButton.textContent = 'Show All Drinks';
                    isGlobalTarotView = true;
                } else {
                    cards.forEach(card => card.classList.remove('is-flipped'));
                    viewToggleButton.textContent = 'Show All Tarot';
                    isGlobalTarotView = false;
                }
            };

            const setupCardEventListeners = () => {
                 document.querySelectorAll('.drink-card[data-name]:not(.listener-added)').forEach(card => {
                    card.classList.add('listener-added');
                    card.addEventListener('click', () => card.classList.toggle('is-flipped'));
                });
                
                document.querySelectorAll('.favorite-btn:not(.listener-added)').forEach(btn => {
                    btn.classList.add('listener-added');
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        btn.classList.toggle('is-favorite');
                        const card = btn.closest('.drink-card');
                        const name = card.dataset.name;
                        const type = btn.dataset.type;

                        if (type === 'drink') {
                            if (btn.classList.contains('is-favorite')) {
                                favoriteDrinks.push(name);
                            } else {
                                favoriteDrinks = favoriteDrinks.filter(fav => fav !== name);
                            }
                            localStorage.setItem(DRINKS_FAVORITES_KEY, JSON.stringify(favoriteDrinks));
                        } else {
                            if (btn.classList.contains('is-favorite')) {
                                favoriteTarot.push(name);
                            } else {
                                favoriteTarot = favoriteTarot.filter(fav => fav !== name);
                            }
                            localStorage.setItem(TAROT_FAVORITES_KEY, JSON.stringify(favoriteTarot));
                        }
                    });
                });
            }

            viewToggleButton.addEventListener('click', () => setCardView(!isGlobalTarotView));

            const initializeFavorites = () => {
                const savedDrinkFavs = localStorage.getItem(DRINKS_FAVORITES_KEY);
                const savedTarotFavs = localStorage.getItem(TAROT_FAVORITES_KEY);
                if (savedDrinkFavs) favoriteDrinks = JSON.parse(savedDrinkFavs);
                if (savedTarotFavs) favoriteTarot = JSON.parse(savedTarotFavs);
            };

            initializeFavorites();
            renderMenuInBatches(cocktails);
        });
    </script>
</body>
</html>


